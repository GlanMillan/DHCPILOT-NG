# DHCP管理系统配置向导

这个配置向导可以帮助你快速设置DHCP管理系统的所有必要配置。

## 快速开始

### 使用自动化脚本（推荐）

1. 给脚本添加执行权限：
```bash
chmod +x setup.sh
```

2. 运行部署脚本：

使用交互式配置：
```bash
sudo ./setup.sh
```

使用命令行参数指定数据库密码：
```bash
sudo ./setup.sh --password your_password
```

可用的命令行参数：
- `-h, --help`：显示帮助信息
- `-p, --password PASSWORD`：直接指定数据库密码

脚本会自动完成以下操作：
- 检查系统环境
- 创建必要的目录
- 生成配置文件
- 设置正确的文件权限
- 启动所有服务
- 检查服务运行状态

### 手动配置

如果你需要更细粒度的控制，可以使用Python配置向导手动配置：

## 前置条件

- Python 3.6 或更高版本
- 操作系统：Linux, macOS, 或 Windows
- Docker 和 Docker Compose 已安装

## 使用方法

1. 确保你在项目根目录下：
```bash
cd /path/to/dhcp-project
```

2. 给配置脚本添加执行权限（Linux/macOS）：
```bash
chmod +x setup.py
```

3. 运行配置向导：
```bash
./setup.py
```

4. 按照提示输入以下配置信息：
   - 服务器IP地址
   - 数据库密码
   - DHCP子网配置
   - DHCP地址池范围
   - 网关IP
   - DNS服务器
   - 邮件服务器配置（可选）

5. 配置完成后，脚本会自动更新以下文件：
   - `.env`：环境变量配置
   - `kea/conf/kea-dhcp4.conf`：DHCP服务配置
   - `bind9/conf/named.conf`：DNS服务配置

## 配置项说明

### 基本配置
- **服务器IP地址**：系统访问地址，用于Web界面访问
- **数据库密码**：PostgreSQL数据库的访问密码

### DHCP配置
- **DHCP子网**：要管理的网段，格式如：192.168.1.0/24
- **地址池范围**：可分配的IP地址范围
- **网关IP**：网络默认网关
- **DNS服务器**：提供给DHCP客户端的DNS服务器地址

### 邮件通知配置（可选）
- **SMTP服务器**：邮件服务器地址
- **SMTP端口**：邮件服务器端口（通常为587）
- **SMTP用户名**：邮件账号
- **SMTP密码**：邮件账号密码

## 安全说明

- JWT密钥和RNDC密钥会自动生成，无需手动配置
- 所有密码和密钥都只保存在本地配置文件中
- 建议在生产环境中使用强密码

## 故障排除

1. 如果自动部署脚本失败：
   - 检查是否有root权限
   - 确认Docker和Docker Compose已正确安装
   - 查看具体错误信息并根据提示解决

2. 如果配置过程中出现错误：
   - 检查文件权限是否正确
   - 确认Python版本是否满足要求（>= 3.6）
   - 验证配置文件是否存在且可写

3. 如果服务启动失败：
   - 使用 `docker-compose ps` 查看容器状态
   - 使用 `docker-compose logs` 查看详细日志
   - 检查端口是否被占用
   - 验证配置文件格式是否正确

## 注意事项

- 首次运行时，建议使用默认值进行测试
- 生产环境部署时，请修改所有默认密码
- 配置完成后，请妥善保管配置文件
- 建议定期备份配置文件和数据库 